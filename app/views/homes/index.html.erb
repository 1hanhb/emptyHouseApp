<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<title>Daum 지도 시작하기</title>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script>
		$(document).ready(function() {
			var placeholderTarget = $('.searchbox input[type="text"]');
			var placeholderTarget2 = $('.span1');
			var placeholderTarget3 = $('.span2');

			placeholderTarget.val('');

			//포커스시
			placeholderTarget.on('focus', function(){
				$(this).siblings('label').fadeOut('fast');
			});

			//포커스아웃시
			placeholderTarget.on('focusout', function(){
				if($(this).val() == ''){
					$(this).siblings('label').fadeIn('fast');
				}
			});

		});



	</script>

</head>

<body>
	<style type="text/css">
		html,body { height:100%; overflow:hidden; padding:0px; }
		.menu-div { width:99.8%; height:60px; box-shadow: 0 0 5px 0 gray; margin: 0 0 5px 0; /*vertical-align: middle; display: table-cell;*/ }

		.map-div { width:70%; height:90%; overflow:auto; }
		.list-div { width:29.8%; height:90%; box-shadow: 0 0 5px 0 gray; overflow:auto }

		.listmenu-div{
			position: absolute;
			width:29.1%;
			height: 35px;
			background-color: rgba( 190, 57, 59, 1 );
		}
		.listmenuspanbox{ width: 100px; height: 75%; margin: 4px 0 0 20px; }
		.listmenu-span{ color: rgba( 255, 255, 255, 1 ); }

		.btn {
			width:42px;
			height:42px;
			border: 0px;
			background-color: rgba( 190, 57, 59, 1 );
			margin: 4px 0 0 428px;
		}

		.btn2 {
			border: 0px;
			color: #999;
			background-color: rgba( 255, 255, 255, 0.5 );
			margin: 13px 0 0 0;
		}

		.searchbox { position: absolute; /*display: inline-block;*/ margin: 4px 0px 0 50px; }
		.searchbox label {
			position: absolute;
			margin: -4px 0 0 0;
			/*display: inline-block;*/
			top: 1px; /* input 요소의 border-top 설정값 만큼 */
			left: 1px; /* input 요소의 border-left 설정값 만큼 */
			padding: .8em .5em; /* input 요소의 padding 값 만큼 */
			color: #999;
			cursor: text;
		}

		.searchbox input[type="text"] {
			width: 400px; /* 원하는 너비 설정 */
			height: 15px; /* 높이값 초기화 */
			line-height : normal; /* line-height 초기화 */
			padding: .8em .5em; /* 원하는 여백 설정, 상하단 여백으로 높이를 조절 */
			font-family: inherit; /* 폰트 상속 */
			border: 2px solid rgba( 190, 57, 59, 1 );
			border-radius: 0; /* iSO 둥근모서리 제거 */
			outline-style: none; /* 포커스시 발생하는 효과 제거를 원한다면 */
			-webkit-appearance: none; /* 브라우저별 기본 스타일링 제거 */
			-moz-appearance: none;
			appearance: none;
		}

		.logo { width:30px; height:30px; margin: 10px 10px 0 0;}

		.span1box { width: 113px; margin: 14px 15px 0 0; }
		.span1{  }
		.span1_line {
			content: '';
   			width: inherit;
   			height: 1px;
   			display: block;
   			position: absolute;
   			margin-top: 2px;
   			border-bottom: 3px solid rgba( 190, 57, 59, 1 );
		}

		.span2box { width: 80px; margin: 14px 21% 0 0; }
		.span2{  }
		.span2_line {
			content: '';
   			width: inherit;
   			height: 1px;
   			display: block;
   			position: absolute;
   			margin-top: 2px;
   			border-bottom: 3px solid rgba( 190, 57, 59, 1 );
		}

	</style>

	<div id="menuBar" class="menu-div">
		<img class="logo" src="32triangle.png" style="float:left;">

		<div class="searchbox" style="float:left;" >
			<label for="ex_input" id="search_label"> 원하시는 지역명을 입력해주세요. </label>
			<input type="text" id="ex_input">
		</div>

		<button class="btn" style="float:left;" id="searchButton" type="submit" onclick="search_click();"><img src="magnifier.png"></button>

		<input class="btn2" type="button" style="float:left;" onclick="sample6_execDaumPostcode()" value="우편번호 찾기">

		<script src="http://dmaps.daum.net/map_js_init/postcode.v2.js"></script>
		<script>
			function sample6_execDaumPostcode() {
				new daum.Postcode({
            				oncomplete: function(data) {
                				// 팝업에서 검색결과 항목을 클릭했을때 실행할 코드를 작성하는 부분.

                				// 각 주소의 노출 규칙에 따라 주소를 조합한다.
                				// 내려오는 변수가 값이 없는 경우엔 공백('')값을 가지므로, 이를 참고하여 분기 한다.
                				var fullAddr = ''; // 최종 주소 변수
                				var extraAddr = ''; // 조합형 주소 변수

                				// 사용자가 선택한 주소 타입에 따라 해당 주소 값을 가져온다.
                				if (data.userSelectedType === 'R') { // 사용자가 도로명 주소를 선택했을 경우
                    					fullAddr = data.roadAddress;

                				} else { // 사용자가 지번 주소를 선택했을 경우(J)
                    					fullAddr = data.jibunAddress;
                				}

                				// 사용자가 선택한 주소가 도로명 타입일때 조합한다.
                				if(data.userSelectedType === 'R'){
                    					//법정동명이 있을 경우 추가한다.
                    					if(data.bname !== ''){
                        					extraAddr += data.bname;
					    		}
					    		// 건물명이 있을 경우 추가한다.
					    		if(data.buildingName !== ''){
                        					extraAddr += (extraAddr !== '' ? ', ' + data.buildingName : data.buildingName);
                    					}
                    					// 조합형주소의 유무에 따라 양쪽에 괄호를 추가하여 최종 주소를 만든다.
                    					fullAddr += (extraAddr !== '' ? ' ('+ extraAddr +')' : '');
                				}

                				// 우편번호와 주소 정보를 해당 필드에 넣는다.
                				document.getElementById('ex_input').value = fullAddr;
            				}
        			}).open();
    			}
		</script>

		<div class="span1box" style="float:right;">
			<span class="span1">로그인/회원가입</span>

			<span class="span1_line"></span>
		</div>

		<div class="span2box" style="float:right;">
			<span class="span2">방 등록하기</span>

			<span class="span2_line"></span>
		</div>

	</div>

	<div class="map-div" id="map" style="float:left;"></div>

	<div class="list-div" style="float:left;">
		<!--
			<% if @user == nil %>
			<%= link_to "Sign in now!", signin_path %>
			<% else %>
			<%= @user.name %>
			<%= link_to "Sign out", signout_path , method: :delete%>
			<% end %>
		-->
		<div class="listmenu-div">
			<div class="listmenuspanbox">
				<span class="listmenu-span"> 검색결과 </span>
			</div>
		</div>
	</div>


	<script type="text/javascript" src="//apis.daum.net/maps/maps3.js?apikey=9097808a820110e22bff0b94f1a2bcb4&libraries=services">
	</script>

	<script>
		var container = document.getElementById('map');
		var options = {
			center: new daum.maps.LatLng(37.557537, 127.000775),
			level: 3
		};

		var map = new daum.maps.Map(container, options);

		// 결과값으로 받은 위치를 마커로 표시합니다
        	var marker = new daum.maps.Marker({
            		map: map,
          	  	position: new daum.maps.LatLng(37.557537, 127.000775)
        	});

		// 인포윈도우로 장소에 대한 설명을 표시합니다
        	var infowindow = new daum.maps.InfoWindow({
            		content: '<div style="width:150px;text-align:center;padding:6px 0;"> 동국대학교 </div>'
        	});
        	infowindow.open(map, marker);

		// 일반 지도와 스카이뷰로 지도 타입을 전환할 수 있는 지도타입 컨트롤을 생성합니다
		var mapTypeControl = new daum.maps.MapTypeControl();

		// 지도에 컨트롤을 추가해야 지도위에 표시됩니다
		// daum.maps.ControlPosition은 컨트롤이 표시될 위치를 정의하는데 TOPRIGHT는 오른쪽 위를 의미합니다
		map.addControl(mapTypeControl, daum.maps.ControlPosition.TOPRIGHT);

		// 지도 확대 축소를 제어할 수 있는  줌 컨트롤을 생성합니다
		var zoomControl = new daum.maps.ZoomControl();
		map.addControl(zoomControl, daum.maps.ControlPosition.RIGHT);

		// 주소-좌표 변환 객체를 생성합니다
		var geocoder = new daum.maps.services.Geocoder();

		function convadd(text) {
			geocoder.addr2coord(text, function(status, result) {

    				// 정상적으로 검색이 완료됐으면
     				if (status === daum.maps.services.Status.OK) {

        				var coords = new daum.maps.LatLng(result.addr[0].lat, result.addr[0].lng);

					marker.setMap(null);
					infowindow.close();

        				// 결과값으로 받은 위치를 마커로 표시합니다
        				marker = new daum.maps.Marker({
            					map: map,
          	  				position: coords
        				});


        				// 인포윈도우로 장소에 대한 설명을 표시합니다
        				infowindow = new daum.maps.InfoWindow({
            					content: '<div style="width:150px;text-align:center;padding:6px 0;">' + text + '</div>'
        				});
        				infowindow.open(map, marker);

    				}  else if (status === daum.maps.services.Status.ZERO_RESULT) {

        				alert('검색 결과가 존재하지 않습니다. \n 우편번호 찾기를 이용해주세요.');
        				return;

    				} else if (status === daum.maps.services.Status.ERROR) {

        				alert('검색 결과 중 오류가 발생했습니다.');
        				return;

    				}
			});
		}

		function search_click() {
			// 주소로 좌표를 검색합니다
			var text = document.getElementById("ex_input").value;

			convadd(text);

			geocoder.addr2coord(text, function(status, result) {
    				// 정상적으로 검색이 완료됐으면
     				if (status === daum.maps.services.Status.OK) {
					var coords = new daum.maps.LatLng(result.addr[0].lat, result.addr[0].lng);

					// 지도의 중심을 결과값으로 받은 위치로 이동시킵니다
        				map.setCenter(coords);
				}
			});
		}

	</script>
</body>
</html>
